'use strict'
/******************************************************************************
  STACK BASE
******************************************************************************/
const { h, hsvg } = require('_h')
const s           = require('_s')
/******************************************************************************
  CUSTOM
******************************************************************************/
var script = document.querySelector('#wistiascript')
if (!script) {
  script = document.createElement('script')
  script.src = '//fast.wistia.com/assets/external/E-v1.js'
  script.async = true
  script.id = 'wistiascript'
  document.head.appendChild(script)
  var _wq = window._wq = window._wq || []
}
/******************************************************************************
  MAIN
******************************************************************************/
module.exports = wistia

function wistia (id, opts, callback) {
  var protocol = opts.protocol || ''
  return h('iframe', {
    src: protocol+'//fast.wistia.net/embed/iframe/' + id,
    className: 'wistia_embed',
    hook: function (node) {
      var video = {}
      video[id] = callback
      _wq.push(video)
    }
  })
}
